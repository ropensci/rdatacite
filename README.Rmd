rdatacite
=========

```{r echo=FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE,
  warning = FALSE,
  message = FALSE
)
```

[![Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed.](http://www.repostatus.org/badges/latest/active.svg)](http://www.repostatus.org/#active)
[![cran checks](https://cranchecks.info/badges/worst/rdatacite)](https://cranchecks.info/pkgs/rdatacite)
[![Build Status](https://travis-ci.org/ropensci/rdatacite.svg?branch=master)](https://travis-ci.org/ropensci/rdatacite)
[![codecov.io](https://codecov.io/github/ropensci/rdatacite/coverage.svg?branch=master)](https://codecov.io/github/ropensci/rdatacite?branch=master)
[![rstudio mirror downloads](https://cranlogs.r-pkg.org/badges/rdatacite)](https://github.com/metacran/cranlogs.app)
[![cran version](https://www.r-pkg.org/badges/version/rdatacite)](https://cran.r-project.org/package=rdatacite)
[![DOI](https://zenodo.org/badge/2521192.svg)](https://zenodo.org/badge/latestdoi/2521192)

`rdatacite` provides programmatic accesses to DataCite (https://datacite.org/) metadata

* REST API. Docs: https://support.datacite.org/docs/api and https://support.datacite.org/reference

`rdatacite` docs: https://docs.ropensci.org/rdatacite

Package API:

```{r echo=FALSE, comment=NA, results='asis'}
cat(paste(" -", paste(sprintf("`%s`", getNamespaceExports("rdatacite")), collapse = "\n - ")))
```

## Installation

Stable CRAN version

```{r eval=FALSE}
install.packages("rdatacite")
```

Development version from github

```{r eval=FALSE}
devtools::install_github("ropensci/rdatacite")
```

```{r}
library('rdatacite')
```

## Result objects

Outputs from nearly all `rdatacite` functions will be of class `dc`, an S3 class that's 
simply a named list of results. You can easily remove the class via `unclass()`.
The `print.dc` method prints the data.frame for the `data`, `included`, and `reports`
slots if they exist, but hides the `meta` named list. You can get to the metadata by
indexing to it like `$meta`.

## Searching

You may want to start with `dc_dois()`.

```{r}
dc_dois(query = "climate change")
```

The `query` parameter supports Elasticearch query string queries. Some examples:

```{r eval=FALSE}
# search within a field
dc_dois(query = "publicationYear:2016")
# fuzzy search (via *) on a nested field
dc_dois(query = "creators.familyName:mil*")
```

## Caching

You can cache HTTP responses by leveraging the `webmiddens` package https://github.com/ropenscilabs/webmiddens

Caching is optional. It does slow down the original request slightly because
we take a bit extra time to cache the data to disk. But all subsequent
requests for the same function call will be faster.

Toggling caching is done through the environment variable `WEBMIDDENS_TURN_OFF`.
Environment variables allow for flexibly turning caching on/off in interactive
as well as non-interactive R sessions.

By default we set `WEBMIDDENS_TURN_OFF = TRUE`, so there's no caching.

To turn on caching, set it to `FALSE` like

```{r eval=FALSE}
Sys.setenv(WEBMIDDENS_TURN_OFF = FALSE)
```

Then do requests as normal; you can tell if you're doing a real HTTP request or not
by using `verbose = TRUE` for verbose curl output. If you don't get the curl
output you are using a cached response. Here, the first request is a real HTTP request,
while the second uses the cached response from the first.

```{r eval=FALSE}
dc_prefixes(limit = 3, verbose = TRUE)
#> > GET /prefixes?page%5Bsize%5D=3&page%5Bnumber%5D=1 HTTP/2
#> Host: api.datacite.org
#> Accept-Encoding: gzip, deflate
#> Accept: application/vnd.api+json; version=2
#> User-Agent: r-curl/4.3 crul/0.9.0 rOpenSci(rdatacite/0.5.2)
#> X-USER-AGENT: r-curl/4.3 crul/0.9.0 rOpenSci(rdatacite/0.5.2)
#> 
#> < HTTP/2 200
#> < date: Tue, 10 Mar 2020 23:30:38 GMT
#> < content-type: application/json; charset=utf-8
#> < status: 200 OK
#> < x-anonymous-consumer: true
#> < cache-control: max-age=0, private, must-revalidate
#> < vary: Accept-Encoding, Origin
#> < content-encoding: gzip
#> < etag: W/"d791baf5c4aa2d98880c67bb889f3d77"
#> < x-runtime: 3.718953
#> < x-request-id: fbbe32a6-263b-40dd-ab1b-f67d5fe92dd6
#> < x-powered-by: Phusion Passenger 6.0.4
#> < server: nginx/1.14.0 + Phusion Passenger 6.0.4

dc_prefixes(limit = 3, verbose = TRUE)
```


## Meta

* Please [report any issues or bugs](https://github.com/ropensci/rdatacite/issues).
* License: MIT
* Get citation information for `rdatacite` in R doing `citation(package = 'rdatacite')`
* Please note that this project is released with a [Contributor Code of Conduct][coc]. By participating in this project you agree to abide by its terms.

[![rofooter](https://ropensci.org/public_images/github_footer.png)](https://ropensci.org)

[coc]: https://github.com/ropensci/rdatacite/blob/master/CODE_OF_CONDUCT.md
